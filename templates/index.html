{% extends "base.html" %}

{% block title %}Drafts en attente - Prospector{% endblock %}

{% block content %}
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2 style="margin: 0;">ğŸ“¬ Drafts en attente de review</h2>
        <div style="background-color: #3498db; color: white; padding: 8px 16px; border-radius: 20px; font-size: 16px; font-weight: bold;">
            {{ drafts|length }} draft{{ 's' if drafts|length > 1 else '' }}
        </div>
    </div>
    
    {% if drafts %}
        <table>
            <thead>
                <tr>
                    <th>Date de crÃ©ation</th>
                    <th>Destinataire</th>
                    <th>Sujet</th>
                    <th>Versions</th>
                    <th>Statut</th>
                    <th>RÃ©ponse</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for draft in drafts %}
                <tr>
                    <td>
                        {% if draft.created_at %}
                            {{ draft.created_at.strftime('%d/%m/%Y %H:%M') if draft.created_at is not string else draft.created_at }}
                        {% else %}
                            -
                        {% endif %}
                    </td>
                    <td>{{ draft.to }}</td>
                    <td>{{ draft.subject }}</td>
                    <td>
                        {% if draft.version_count and draft.version_count > 1 %}
                            <span class="badge badge-info" style="background-color: #3498db; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold;">{{ draft.version_count }}</span>
                        {% else %}
                            <span style="color: #95a5a6;">1</span>
                        {% endif %}
                    </td>
                    <td>
                        <span class="badge badge-{{ draft.status }}">{{ draft.status }}</span>
                    </td>
                    <td>
                        {% if draft.has_reply %}
                            <span style="color: #27ae60; font-weight: bold;">âœ“ RÃ©pondu</span>
                        {% else %}
                            <span style="color: #95a5a6;">-</span>
                        {% endif %}
                    </td>
                    <td>
                        <a href="{{ url_for('main.draft_detail', draft_id=draft.id) }}" class="btn btn-primary">Voir dÃ©tails</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <div class="empty-state">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
            </svg>
            <h3>Aucun draft en attente</h3>
            <p>Tous les drafts ont Ã©tÃ© traitÃ©s âœ¨</p>
        </div>
    {% endif %}
</div>
{% endblock %}